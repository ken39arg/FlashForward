(function(){var k=window.document,g={},f={},e={},q={};g.version="0.0.1";g.display=e;g.geom=f;window.FlashForward=g;var r=0,l=window.console,t=function(a,b){a!==void 0&&(r=a);if(b!==!0||!l)l={log:function(){},debug:function(){},info:function(){},warn:function(){},error:function(){}}},s=function(a,b,c,d){var e=!1,i=new XMLHttpRequest;d==null&&(d=[]);i.onreadystatechange=function(){!e&&i.readyState===4&&(e=!0,d.unshift(i),c.apply(b,d))};i.open("GET",a,!0);i.setRequestHeader("Content-Type","application/x-www-form-urlencoded");
i.send(null)},n=function(a){var b={},c;for(c in a)b[c]=a[c];return b},j=function(a,b){function c(){}c.prototype=b.prototype;a.superClass_=b.prototype;a.prototype=new c;a.prototype.constructor=a};g.Event=function(a){this.type=a;this.target=null};g.Event.ENTER_FRAME="enterFrame";g.EventDispatcher=function(){this.eventListers={}};g.EventDispatcher.prototype.addEventListener=function(a,b){var c=this.eventListers[a];c===null?this.eventListers[a]=[b]:c.indexOf(b)===-1&&c.push(b)};g.EventDispatcher.prototype.removeEventListner=
function(a,b){var c=this.eventListers[a];if(c!=null){var d=c.indexOf(b);d!==-1&&c.splice(d,1)}};g.EventDispatcher.prototype.dispatchEvent=function(a){if(a.target===null)a.target=this;var b=this.eventListers[a.type];if(b!=null)for(var c=0,d=b.length;c<d;c++)b[c].call(this,a)};g.Player=function(a,b,c,d,e,i){var o=k.getElementById(b);t(i!==void 0?i:window.DEV_TIMEOUT,e!==void 0?e:window.IS_DEV);g.EventDispatcher.call(this);this.frameAt=this.startAt=null;this.context=new g.Context;this.context.setUrl(a);
typeof c==="object"?this.context.setRenderer(c):c==="canvas"?this.context.setRenderer(q.canvas):this.context.setRenderer(q.svg);this.screenSize={width:o.getAttribute("width")?o.getAttribute("width"):240,height:o.getAttribute("height")?o.getAttribute("height"):320};this.target=b;this.dom=k.createElementNS("","div");this.dom.setAttributeNS("","id",this.target);this.fixDisplay=!!d;this.intervalId=null};j(g.Player,g.EventDispatcher);g.Player.prototype.play=function(){s(this.context.url,this,this.onLoad)};
g.Player.prototype.onLoad=function(a){var b=this,a=eval("("+a.responseText+")");this.context.loadMeta(a.meta);this.context.loadStage(a.ctls);this.context.loadDictionary(a.dict);this.updateScreenSize();if(!this.fixDisplay)window.onresize=function(){b.updateScreenSize()};this.startAt=Date.now();this.loading()};g.Player.prototype.setupScreen=function(){var a=k.getElementById(this.target);a.parentNode.replaceChild(this.dom,a);this.dom.appendChild(this.context.stage.dom)};g.Player.prototype.loading=function(){var a=
this;if(this.context.isLoadComplete()){if(l.log("load complete"),this.frameAt=Date.now(),this.intervalId===null)this.setupScreen(),this.intervalId=setInterval(function(){a.next()},this.context.interval)}else setTimeout(function(){a.loading()},this.context.interval)};g.Player.prototype.next=function(){try{Date.now()-this.frameAt>10&&(this.context.stage.advance(),this.context.stage.processActionQueue(),this.context.stage.display())}catch(a){l.error(a)}this.frameAt=Date.now();if(0<r&&r<Date.now()-this.startAt)clearInterval(this.intervalId),
this.intervalId=null,l.info("Stop interval time "+r)};g.Player.prototype.updateScreenSize=function(){var a=this.screenSize;this.fixDisplay||(k.documentElement&&k.documentElement.clientWidth!==0?a={width:k.documentElement.clientWidth,height:k.documentElement.clientHeight}:k.body&&(a={width:k.body.clientWidth,height:k.body.clientHeight}));this.context.ratio=this.context.stage.rect.width()/a.width;if(this.context.stage.rect.height()/this.context.ratio>a.height)this.context.ratio=this.context.stage.rect.height()/
a.height;this.context.stage.updateSize()};g.Context=function(){this.version=this.interval=this.fps=this.baseurl=this.url=-1;this.ratio=20;this.dictionary={};this.stage=-1;this.renderer={}};g.Context.prototype.setUrl=function(a){this.url=a;this.baseurl=a.slice(0,a.lastIndexOf("/"))};g.Context.prototype.setRenderer=function(a){this.renderer=a};g.Context.prototype.loadMeta=function(a){this.fps=a.fps;this.interval=1E3/this.fps;this.version=a.version;this.stage=new e.Stage(null,this);this.stage.loadMeta(a);
l.log(this)};g.Context.prototype.loadDictionary=function(a){var b=-1,c,d=[];for(b in a){c=a[b];switch(c.type){case "bitmap":this.addDisplayObject(c,new e.Bitmap);break;case "shape":this.addDisplayObject(c,new e.Shape);break;case "font":this.addDisplayObject(c,new e.Font);break;case "text":this.addDisplayObject(c,new e.Text);break;case "sprite":this.addDisplayObject(c,new e.Sprite);break;default:l.warn("unknown type "+c.type),s(this.baseurl+"/"+a[b].url,this,this.loadCallBack)}c.url&&-1===d.indexOf(c.url)&&
(c.type==="bitmap"?this.initBitmap_(c):d.push(c.url))}for(b in d)s(this.baseurl+"/"+d[b],this,this.loadCallBack)};g.Context.prototype.loadStage=function(a){this.stage.setup("root",a,this);this.stage.first();this.stage.loadControls(a)};g.Context.prototype.isLoadComplete=function(){for(var a in this.dictionary)if(this.dictionary[a].isLoaded===!1)return l.log(a+" is not loaded ",this.dictionary[a]),!1;return!0};g.Context.prototype.addDisplayObject=function(a,b){b.type=a.type;b.url=this.baseurl+"/"+a.url;
b.cid=a.cid;this.dictionary[a.cid]=b};g.Context.prototype.loadCallBack=function(a){a.getResponseHeader("Content-Type").indexOf("svg")!==-1?this.initSVG_(a.responseXML):this.initObject_(eval("("+a.responseText+")"))};g.Context.prototype.setupDisplayObject_=function(a,b){var c=this.dictionary[a];c==void 0&&l.error("undefined: "+a,b);c.setup(a,b,this)};g.Context.prototype.initBitmap_=function(a){this.setupDisplayObject_(a.cid,a)};g.Context.prototype.initSVG_=function(a){for(var b=0,c,d=a.getElementsByTagName("defs"),
b=d.item(0).childNodes.length,a=0;a<b;++a)c=d.item(0).childNodes.item(a),this.setupDisplayObject_(c.getAttributeNS(null,"id"),c)};g.Context.prototype.initObject_=function(a){var b,c;for(b in a)c=a[b],this.setupDisplayObject_(b,c)};var p=function(a,b){this.actionTarget=this.target=a;this.stack=[];this.points=[];this.commands=[];this.index=0;for(var c in b)this.points.push(parseInt(c)),this.commands.push(b[c])};p.prototype.execute=function(){var a=[];for(this.actionTarget=this.target;a=this.getNextCommand_();){if(a[0]===
0)break;try{this.exec_(a[0],a[1])}catch(b){l.error(b,a,this.stack)}}};p.prototype.push_=function(a){this.stack.push(a)};p.prototype.pop_=function(){return this.stack.pop()};p.prototype.getNextCommand_=function(){return this.commands[this.index++]};p.prototype.jump_=function(a){this.index=this.points.indexOf(parseInt(a));this.index===-1&&l.error("goto point is undefined. "+a,this.commands,this.points)};p.prototype.exec_=function(a,b){switch(a){case 150:this.push_(b[0]);break;case 23:this.pop_();break;
case 157:this.pop_()&&this.jump_(b[0]);break;case 153:this.jump_(b[0]);break;case 29:var c=this.pop_(),d=this.pop_(),e=[];if(d===void 0)return l.error("#"+this.target.id+".Action::set name is undefined"),!1;d.indexOf(":")>0?(e=d.split(":"),this.actionTarget.resolvePath(e[0]).setVars(e[1],c)):this.actionTarget.setVars(d,c);break;case 28:d=this.pop_();c="";if(d===void 0)return l.error("#"+this.target.id+".Action::set name is undefined"),!1;d.indexOf(":")>0?(e=d.split(":"),c=this.actionTarget.resolvePath(e[0]).getVars(e[1])):
c=this.actionTarget.getVars(d);this.push_(c);break;case 158:this.actionTarget.callAction(this.pop_());break;case 10:case 71:c=Number(this.pop_());d=Number(this.pop_());this.target.context.version<=4&&(isNaN(c)&&(c=0),isNaN(d)&&(d=0));this.push_(d+c);break;case 11:c=Number(this.pop_());d=Number(this.pop_());this.target.context.version<=4&&(isNaN(c)&&(c=0),isNaN(d)&&(d=0));this.push_(d-c);break;case 12:c=Number(this.pop_());d=Number(this.pop_());this.target.context.version<=4&&(isNaN(c)&&(c=0),isNaN(d)&&
(d=0));this.push_(d*c);break;case 13:c=Number(this.pop_());d=Number(this.pop_());this.target.context.version<=4&&(isNaN(c)&&(c=0),isNaN(d)&&(d=0));this.push_(d/c);break;case 14:case 19:c=this.pop_();d=this.pop_();this.push_(d==c);break;case 15:c=this.pop_();d=this.pop_();this.push_(d<c);break;case 16:c=this.pop_();d=this.pop_();this.push_(Boolean(d&&c));break;case 17:c=this.pop_();d=this.pop_();this.push_(Boolean(d||c));break;case 18:c=this.pop_();this.push_(Boolean(!c));break;case 33:c=""+this.pop_();
d=""+this.pop_();c==="undefined"&&(c="");d==="undefined"&&(d="");this.push_(d.concat(c));break;case 21:c=parseInt(this.pop_());d=parseInt(this.pop_());e=""+this.pop_();this.push_(e.substr(d-1,c));break;case 20:e=""+this.pop_();this.push_(e.length);break;case 24:b=parseInt(this.pop_(),10);this.push_(b);break;case 6:this.actionTarget.play();break;case 7:this.actionTarget.stop();break;case 4:this.actionTarget.nextFrame();break;case 5:this.actionTarget.previousFrame();break;case 159:if(this.actionTarget===
void 0&&this.target.context.version<=4)break;this.actionTarget.gotoFrame(this.pop_(),b[0]);break;case 129:this.actionTarget.gotoFrame(parseInt(b[0])+1,b[1]);break;case 140:this.actionTarget.gotoFrame(b[0],b[1]);break;case 139:this.actionTarget=(d=b[0])?this.target.resolvePath(d):this.target;this.actionTarget===void 0&&l.error("Not found target="+d+" base="+this.target.name+" base_frame="+this.target.currentFrame);break;case 32:this.actionTarget=(d=this.pop_())?this.target.resolvePath(d):this.target;
this.actionTarget===void 0&&l.error("Not found target="+d+" base="+this.target.name+" base_frame="+this.target.currentFrame);break;case 34:e=this.pop_();d=(d=this.pop_())?this.actionTarget.resolvePath(d):this.actionTarget;this.push_(d.getProperty(e));break;case 35:c=this.pop_();e=this.pop_();d=(d=this.pop_())?this.actionTarget.resolvePath(d):this.actionTarget;d.setProperty(e,c);break;case 36:c=parseInt(this.pop_());d=""+this.pop_();this.actionTarget.cloneSprite(""+this.pop_(),d,c);break;case 52:break;
case 48:c=this.pop_();this.push_(Math.floor(Math.random()*c));break;case 38:c=this.pop_();l.log("trace",c);break;case 0:break;case 45:c=this.pop_();for(d=0;d<c;++d)this.pop_();break;default:l.warn("Unknown Action "+a,b)}};f.Rect=function(a){this.ymax=this.xmax=this.ymin=this.xmin=0;a&&(typeof a==="object"&&a.length===4?this.fromArray(a):typeof a==="string"&&a.indexOf(" ")&&this.fromArray(a.split(" ")))};f.Rect.prototype.width=function(){return this.xmax-this.xmin};f.Rect.prototype.height=function(){return this.ymax-
this.ymin};f.Rect.prototype.toString=function(){return"rect("+this.xmin+","+this.ymin+","+this.xmax+","+this.ymax+")"};f.Rect.prototype.fromArray=function(a){this.xmin=a[0];this.ymin=a[1];this.xmax=a[2];this.ymax=a[3]};f.Rect.prototype.add=function(a){if(a.xmin<this.xmin)this.xmin=a.xmin;if(this.xmax<a.xmax)this.xmax=a.xmax;if(a.ymin<this.ymin)this.ymin=a.ymin;if(this.ymax<a.ymax)this.ymax=a.ymax};f.Rect.prototype.addTransformd=function(a,b){var c=a.xmin,d=a.xmax,e=a.ymin,i=a.ymax,o=b.transform(c,
e),c=b.transform(c,i),e=b.transform(d,e),d=b.transform(d,i);this.expandTo(o.x,o.y);this.expandTo(c.x,c.y);this.expandTo(e.x,e.y);this.expandTo(d.x,d.y)};f.Rect.prototype.expandTo=function(a,b){if(a<this.xmin)this.xmin=a;if(this.xmax<a)this.xmax=a;if(b<this.ymin)this.ymin=b;if(this.ymax<b)this.ymax=b};f.Matrix=function(a){this.a=1;this.c=this.b=0;this.d=1;this.ty=this.tx=0;typeof a==="object"&&a.length===6?this.fromArray(a):typeof a==="string"&&this.fromString(a)};f.Matrix.prototype.toString=function(){return"matrix("+
this.a+","+this.b+","+this.c+","+this.d+","+this.tx+","+this.ty+")"};f.Matrix.prototype.toArray=function(){return[this.a,this.b,this.c,this.d,this.tx,this.ty]};f.Matrix.prototype.fromString=function(a){this.fromArray(/\(([0-9,\.\-]*)\)/.exec(a.replace(" ",","))[1].split(","))};f.Matrix.prototype.fromArray=function(a){this.a=Number(a[0]);this.b=Number(a[1]);this.c=Number(a[2]);this.d=Number(a[3]);this.tx=Number(a[4]);this.ty=Number(a[5])};f.Matrix.prototype.add=function(a){var b=new f.Matrix;b.a=this.a*
a.a+this.c*a.b;b.b=this.b*a.a+this.d*a.b;b.c=this.a*a.c+this.c*a.d;b.d=this.b*a.c+this.d*a.d;b.tx=this.a*a.tx+this.c*a.ty+this.tx;b.ty=this.b*a.tx+this.d*a.ty+this.ty;return b};f.Matrix.prototype._rotationX=function(){return Math.atan2(this.b,this.a)};f.Matrix.prototype._rotationY=function(){return Math.atan2(-this.c,this.d)};f.Matrix.prototype.set_x=function(a){this.tx=a};f.Matrix.prototype.get_x=function(){return this.tx};f.Matrix.prototype.set_y=function(a){this.ty=a};f.Matrix.prototype.get_y=
function(){return this.ty};f.Matrix.prototype.set_xscale=function(a){var b=this._rotationX();this.a=a*Math.cos(b);this.b=a*Math.sin(b)};f.Matrix.prototype.get_xscale=function(){return Math.sqrt(Math.pow(this.a,2)+Math.pow(this.b,2))};f.Matrix.prototype.set_yscale=function(a){var b=this._rotationY();this.c=-1*a*Math.sin(b);this.d=a*Math.cos(b)};f.Matrix.prototype.get_yscale=function(){return Math.sqrt(Math.pow(this.c,2)+Math.pow(this.d,2))};f.Matrix.prototype.set_rotation=function(a){var b=this._rotationX(),
c=this._rotationY(),d=this.get_xscale(),e=this.get_yscale();this.a=d*Math.cos(a);this.b=d*Math.sin(a);this.c=-1*e*Math.sin(c-b+a);this.d=e*Math.cos(c-b+a)};f.Matrix.prototype.get_rotation=function(){return this._rotationX()};f.Matrix.prototype.transform=function(a,b){return{x:this.a*a+this.c*b+this.tx,y:this.b*a+this.d*b+this.ty}};f.Cxform=function(a){this.ma=this.mb=this.mg=this.mr=1;this.aa=this.ab=this.ag=this.ar=0;typeof a==="object"&&a.length===8&&this.fromArray(a)};f.Cxform.prototype.toString=
function(){return"cxform("+this.mr+","+this.mg+","+this.mb+","+this.ma+","+this.ar+","+this.ag+","+this.ab+","+this.aa+")"};f.Cxform.prototype.fromArray=function(a){this.mr=a[0];this.mg=a[1];this.mb=a[2];this.ma=a[3];this.ar=a[4];this.ag=a[5];this.ab=a[6];this.aa=a[7]};f.Cxform.prototype.toArray=function(){return[this.mr,this.mg,this.mb,this.ma,this.ar,this.ag,this.ab,this.aa]};f.Cxform.prototype.set_alpha=function(a){this.ma=a};f.Cxform.prototype.get_alpha=function(){return this.ma};f.Cxform.prototype.transform=
function(a,b,c,d){var e={};d===void 0&&(d=1);e.r=Math.max(0,Math.min(a*this.mr+this.ar,255));e.g=Math.max(0,Math.min(b*this.mg+this.ag,255));e.b=Math.max(0,Math.min(c*this.mb+this.ab,255));e.a=Math.max(0,Math.min(d*this.ma+this.aa,1));return e};e.Display=function(){g.EventDispatcher.call(this);this.name=this.id=this.parent=null;this.depth=0;this.node=this.visible=this.rect=this.transform=null;this.isUpdate=!1;this.clipDepth=0;this.clipId=null;this.isLoaded=this.locked=this.isAppended=!1};j(e.Display,
g.EventDispatcher);e.Display.prototype.getRenderer=function(){return this.context.renderer.Display};e.Display.prototype.setup=function(a,b,c){this.cid=a;this.context=c;this.loadContent(b);return this};e.Display.prototype.clone=function(){var a=new e.Display;a.cid=this.cid;a.url=this.url;a.type=this.type;a.context=this.context;return a};e.Display.prototype.remove=function(){this.depth=0;this.visible=this.id=this.cid=this.transform=this.context=this.rect=this.name=this.parent=this.node=null;this.locked=
this.isAppended=this.isUpdate=!1};e.Display.prototype.loadContent=function(a){this.getRenderer().load(this,a)};e.Display.prototype.advance=function(){};e.Display.prototype.processActionQueue=function(){};e.Display.prototype.display=function(){this.getRenderer().preRender(this)&&this.getRenderer().render(this);this.isUpdate=!1};e.Display.prototype.added=function(){};e.Display.prototype.first=function(){this.getRenderer().first(this)};e.Display.prototype.updateTransform=function(a,b){if(this.locked!==
!0){if(!this.transform)this.transform={matrix:null,cxform:null};if(a&&(a=new f.Matrix(a),a!=this.transform.matrix))this.transform.matrix=a,this.isUpdate=!0;if(b&&(b=new f.Cxform(b),b!=this.transform.cxform))this.transform.cxform=b,this.isUpdate=!0}};e.Display.prototype.buildId=function(){this.id=this.parent?this.parent.id:"";this.id+="-"+this.cid+"-"+this.depth};e.Display.prototype.getRect=function(){return this.rect};e.Display.prototype.getProperty=function(a){switch(parseInt(a)){case 0:return this.transform.matrix.get_x()/
20;case 1:return this.transform.matrix.get_y()/20;case 2:return this.transform.matrix.get_xscale()*100;case 3:return this.transform.matrix.get_yscale()*100;case 4:return this.currentFrame+1;case 5:return this.frameCount;case 6:return this.transform.cxform.get_alpha();case 7:return this.visible==="hidden"?!1:!0;case 8:return a=new f.Rect,a.addTransformd(this.getRect(),this.transform.matrix),a.width()/20;case 9:return a=new f.Rect,a.addTransformd(this.getRect(),this.transform.matrix),a.height()/20;
case 10:return this.transform.matrix.get_rotation();case 13:return this.name}l.warn("get undefined property '"+a+"'");return null};e.Display.prototype.setProperty=function(a,b){this.locked=this.isUpdate=!0;switch(parseInt(a)){case 0:return this.transform.matrix.set_x(b*20);case 1:return this.transform.matrix.set_y(b*20);case 2:return this.transform.matrix.set_xscale(b/100);case 3:return this.transform.matrix.set_yscale(b/100);case 6:return this.transform.cxform.set_alpha(b);case 7:return this.visible=
b!=0?"visible":"hidden";case 10:return this.transform.matrix.set_rotation(b);case 13:return this.name=b}l.warn("set undefined property '"+a+"' to '"+b+"'")};e.Bitmap=function(){e.Display.call(this)};j(e.Bitmap,e.Display);e.Bitmap.prototype.getRenderer=function(){return this.context.renderer.Bitmap};e.Bitmap.prototype.clone=function(){var a=new e.Bitmap;a.cid=this.cid;a.context=this.context;a.rect=this.rect;a.url=this.url;a.type=this.type;a.content=this.content;return a};e.Shape=function(){e.Display.call(this)};
j(e.Shape,e.Display);e.Shape.prototype.getRenderer=function(){return this.context.renderer.Shape};e.Shape.prototype.clone=function(){var a=new e.Shape;a.cid=this.cid;a.context=this.context;a.rect=this.rect;a.url=this.url;a.type=this.type;a.content=this.content;return a};e.Font=function(){e.Display.call(this)};j(e.Font,e.Display);e.Font.prototype.getRenderer=function(){return this.context.renderer.Font};e.Font.prototype.clone=function(){var a=new e.Font;a.cid=this.cid;a.context=this.context;a.rect=
this.rect;a.url=this.url;a.type=this.type;return a};e.Text=function(){e.Display.call(this)};j(e.Text,e.Display);e.Text.prototype.getRenderer=function(){return this.context.renderer.Text};e.Text.prototype.loadContent=function(a){this.rect=new f.Rect(a.meta.size);this.style=a.style;this.text=this.initialText=a.text?a.text:"";this.variable=a.variable?a.variable:!1;this.updateText=!1;e.Display.prototype.loadContent.call(this,a)};e.Text.prototype.clone=function(){var a=new e.Text;a.cid=this.cid;a.context=
this.context;a.rect=this.rect;a.style=this.style;a.text="";a.initialText=this.initialText;a.variable=this.variable;a.url=this.url;a.type=this.type;return a};e.Text.prototype.advance=function(){if(this.variable!==!1){var a=this.text;if(this.variable.indexOf(":")>0)var a=this.variable.split(":"),b=this.parent.resolvePath(a[0]),a=b?b.getVars(a[1]):"";else a=this.parent.getVars(this.variable);if(a!==this.text)this.text=a,this.updateText=!0}};e.Text.prototype.display=function(){e.Display.prototype.display.call(this);
this.updateText&&this.getRenderer().updateText(this)};e.DisplayContainer=function(){e.Display.call(this);this.currentFrame=0;this.renderFrame=-1;this.frameCount=0;this.playing=!0;this.vars={};this.clipLayer=[];this.actionQueue=[];this.displayList=[]};j(e.DisplayContainer,e.Display);e.DisplayContainer.prototype.clone=function(){var a=new e.DisplayContainer;a.cid=this.cid;a.context=this.context;a.controls=this.controls;return a};e.DisplayContainer.prototype.remove=function(a){this.clipLayer=[];this.displayList=
[];this.actionQueue=[];e.Display.prototype.remove.call(this,a)};e.DisplayContainer.prototype.loadControls=function(a){this.controls=a;this.frameCount=a.length};e.DisplayContainer.prototype.added=function(){};e.DisplayContainer.prototype.advance=function(){var a,b=0,c=this.displayList;this.playing&&this.renderFrame!==this.currentFrame&&this.updateDisplay();b=c.length;for(a=0;a<b;++a)c[a].advance()};e.DisplayContainer.prototype.processActionQueue=function(){for(var a,b=0,c=this.displayList;a=this.actionQueue.shift();)a.execute();
b=c.length;for(a=0;a<b;++a)c[a].processActionQueue()};e.DisplayContainer.prototype.display=function(){var a=this.getRenderer(),b=this.displayList,c,d,e=0;if(a.preRender(this)){e=b.length;for(d=0;d<e;++d)c=b[d],c.isAppended===!1&&c.first(),a.rendererChild(this,c,b[d-1]),c.display(),c.isAppended=!0;a.render(this)}this.isUpdate=!1;this.playing&&this.nextFrame()};e.DisplayContainer.prototype.play=function(){this.playing=!0};e.DisplayContainer.prototype.stop=function(){this.playing=!1};e.DisplayContainer.prototype.nextFrame=
function(){++this.currentFrame;if(this.currentFrame>=this.frameCount)this.currentFrame=0};e.DisplayContainer.prototype.previousFrame=function(){--this.currentFrame;if(this.currentFrame<0)this.currentFrame=0};e.DisplayContainer.prototype.gotoFrame=function(a,b){var c=this.currentFrame;this.currentFrame=isFinite(a)?a>1?a-1:0:this._getIndexByLabel(a);if(this.controls.length<this.currentFrame)this.currentFrame=this.controls.length-1;this.playing=b;var d=this.controls[this.currentFrame];if(c!==this.currentFrame){var e=
d.d,i=this.displayList,o,f,h=!1,l,g,j=0,k=[];g=i.length;for(c=0;c<g;++c){h=!1;o=i[c];j=e.length;for(l=0;l<j;++l)if(f=e[l],f.dp==o.depth&&f.cid==o.cid){h=!0;break}h===!1&&k.push(o.depth)}g=k.length;for(c=0;c<g;++c)this.removeChildAt(k[c]);this._displayDisplay(d.d);this._actionDisplay(d.act);d=this.displayList;g=d.length;for(c=0;c<g;++c)d[c].advance()}};e.DisplayContainer.prototype.updateDisplay=function(){var a=this.controls[this.currentFrame];this._removesDisplay(a.rm);this._displayDisplay(a.d);this._actionDisplay(a.act)};
e.DisplayContainer.prototype._removesDisplay=function(a){if(a!==void 0)for(var b=a.length,c=0;c<b;++c)this.removeChildAt(a[c])};e.DisplayContainer.prototype._displayDisplay=function(a){var b,c,d,e=0,i,f,h;this.renderFrame=this.currentFrame;d=a.length;for(b=0;b<d;++b){i=a[b];(f=this.getChildAt(i.dp))&&f.cid!==i.cid&&this.removeChildAt(i.dp);if(!f||f.context==null){c=this.context.dictionary[i.cid];if(c===void 0){l.warn("not found define "+i.cid);continue}f=c.clone();if(f.context==null){l.error(f,i);
continue}}if(i.name)f.name=i.name;f.updateTransform(i.mtx,i.cx);f.parent===null&&this.addChildAt(i.dp,f);if(this.clipLayer.length>0){e=this.clipLayer.length;for(c=0;c<e;++c)if(h=this.clipLayer[c],h.from<i.dp&&i.dp<=h.to)f.clipId=h.id}if(i.cdp&&f.clipDepth!=i.cdp)f.clipDepth=i.cdp,this.clipLayer.push({id:f.id,from:i.dp,to:i.cdp})}};e.DisplayContainer.prototype._actionDisplay=function(a){var b,c=0;if(a&&(c=a.length)>0)for(b=0;b<c;++b)this.actionQueue.push(new p(this,a[b]))};e.DisplayContainer.prototype.addChildAt=
function(a,b){var c=this.displayList;b.parent=this;b.depth=a;b.buildId();b.added();c.push(b);c.sort(this.context.renderer.displaySort)};e.DisplayContainer.prototype.getChildAt=function(a){for(var b=this.displayList,c=b.length,d=0;d<c;++d)if(b[d].depth===a)return b[d]};e.DisplayContainer.prototype.getChildByName=function(a){for(var b=this.displayList,c=b.length,d=0;d<c;++d)if(b[d].name===a)return b[d]};e.DisplayContainer.prototype.resolvePath=function(a){if(this.cid!=="root"&&this.parent===null)throw"Error: parent is null."+
this.cid;if(a==="")return this;var b=a.indexOf("/");switch(b){case -1:return this.getChildByName(a);case 0:return this.context.stage.resolvePath(a.substring(1));default:var c=a.substring(0,b);return c===".."?this.parent.resolvePath(a.substring(b+1)):(c=this.getChildByName(c))?c.resolvePath(a.substring(b+1)):void 0}};e.DisplayContainer.prototype.removeChildAt=function(a){for(var b,c=this.displayList,d=b=c.length-1;0<=d;--d)b=c[d],b.depth===a&&(b.isAppended&&this.getRenderer().removeChild(this,b),b.remove(),
c.splice(d,1));b=this.clipLayer.length;if(b>0)for(d=0;d<b;++d)(c=this.clipLayer[d])&&c.from===a&&this.clipLayer.splice(d,1)};e.DisplayContainer.prototype.cloneSprite=function(a,b,c){var d=this.resolvePath(a),a=d.clone(),e=d.transform.matrix?d.transform.matrix.toArray():[1,0,0,1,0,0],d=d.transform.cxform?d.transform.cxform.toArray():[1,1,1,1,0,0,0,0];a.name=b;a.updateTransform(e,d);this.addChildAt(c,a);a.advance()};e.DisplayContainer.prototype.setVars=function(a,b){this.vars[a]=b};e.DisplayContainer.prototype.getVars=
function(a){return this.vars[a]};e.DisplayContainer.prototype.callAction=function(a){a=this.controls[this._getIndexByLabel(a)];if(!a)return!1;var a=a.act,b,c=0,d;if(a&&(c=a.length)>0)for(b=0;b<c;++b)d=new p(this,a[b]),d.execute();return!0};e.DisplayContainer.prototype._getIndexByLabel=function(a){for(var b,c=this.controls.length,d=0;d<c;++d)if(b=this.controls[d],b.label&&b.label===a)return d;return 0};e.Sprite=function(){e.DisplayContainer.call(this)};j(e.Sprite,e.DisplayContainer);e.Sprite.prototype.getRenderer=
function(){return this.context.renderer.Sprite};e.Sprite.prototype.loadContent=function(a){e.DisplayContainer.prototype.loadContent.call(this,a);this.frameCount=a.meta.fcon;this.loadControls(a.ctls)};e.Sprite.prototype.clone=function(){var a=new e.Sprite;a.cid=this.cid;a.context=this.context;a.frameCount=this.frameCount;a.controls=this.controls;a.url=this.url;a.type=this.type;return a};e.Sprite.prototype.getRect=function(){var a,b,c=0;if(this.rect==null){this.rect=new f.Rect;c=this.displayList.length;
for(b=0;b<c;++b)a=this.displayList[b],a.transform.matrix?this.rect.addTransformd(a.getRect(),a.transform.matrix):this.rect.add(a.getRect())}return this.rect};e.Sprite.prototype.updateDisplay=function(){this.rect=null;e.DisplayContainer.prototype.updateDisplay.call(this)};e.Stage=function(){e.DisplayContainer.call(this);this.id="root"};j(e.Stage,e.DisplayContainer);e.Stage.prototype.getRenderer=function(){return this.context.renderer.Stage};e.Stage.prototype.clone=function(){throw"Stage is not created clone";
};e.Stage.prototype.loadMeta=function(a){this.frameCount=a.fcon;this.rect=new f.Rect(a.size);this.bgcolor=a.bgcolor};e.Stage.prototype.updateSize=function(){this.getRenderer().updateSize(this)};j={displaySort:function(a,b){return b.depth-a.depth},Display:{load:function(a){a.isLoaded=!0},first:function(a){var b=k.createElementNS("http://www.w3.org/2000/svg","use");b.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href","#"+a.cid);a.name&&b.setAttributeNS(null,"class",a.name);if(a.clipDepth){var c=
k.createElementNS("http://www.w3.org/2000/svg","clipPath");c.setAttributeNS(null,"id",a.id);c.appendChild(b);a.node=c}else b.setAttributeNS(null,"id",a.id),a.node=b},preRender:function(){return!0},render:function(a){if(a.isUpdate!==!1){var b=a.clipDepth===0?a.node:a.node.childNodes[0];a.visible!==null&&b.setAttributeNS(null,"visibility",a.visible);if(a.visible!=="hidden")a=a.transform,a.matrix&&b.setAttributeNS(null,"transform",a.matrix.toString()),a.cxform&&b.setAttributeNS(null,"opacity",a.cxform.ma)}},
remove:function(){}}};j.Shape=n(j.Display);j.Shape.load=function(a,b){var c=k.importNode(b,!0);a.context.stage.defs.appendChild(c);a.rect=new f.Rect(c.getAttribute("viewBox"));a.isLoaded=!0};j.Bitmap=n(j.Display);j.Bitmap.load=function(a,b){a.url=a.context.baseurl+"/"+b.url;a.rect=new f.Rect([0,0,b.width,b.height]);var c=k.createElementNS("http://www.w3.org/2000/svg","image");c.setAttributeNS(null,"id",a.cid);c.setAttributeNS(null,"width",a.rect.width());c.setAttributeNS(null,"height",a.rect.height());
c.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",a.url);a.context.stage.defs.appendChild(c);a.isLoaded=!0};j.Font=n(j.Shape);j.Text=n(j.Display);j.Text.first=function(a){var b=k.createElementNS("http://www.w3.org/2000/svg","text");b.setAttributeNS(null,"id",a.id);a.name&&b.setAttributeNS(null,"class",a.name);if(a.style.align)switch(a.style.align){case "left":b.setAttributeNS(null,"text-anchor","start");b.setAttributeNS(null,"x",a.rect.xmin);break;case "center":b.setAttributeNS(null,"text-anchor",
"middle");b.setAttributeNS(null,"x",a.rect.width()/2+a.rect.xmin);break;case "right":b.setAttributeNS(null,"text-anchor","end"),b.setAttributeNS(null,"x",a.rect.xmax)}b.setAttributeNS(null,"y",a.style.size+a.rect.ymin);a.style["word-wrap"]&&l.warn("word-wrap is no support on SVG");a.style.multiline&&l.warn("multiline is no support on SVG");a.style.border&&l.warn("border is not implement on SVG");a.style.size&&b.setAttributeNS(null,"font-size",a.style.size);a.style.color&&b.setAttributeNS(null,"fill",
a.style.color);a.style.opacity&&b.setAttributeNS(null,"opacity",Number(a.style.opacity));a.style["left-mergin"]&&l.warn("left-mergin is not implement on SVG");a.style["right-mergin"]&&l.warn("right-mergin is not implement on SVG");a.style.indent&&l.warn("indent is not implement on SVG");a.style.leading&&l.warn("leading is not implement on SVG");a.style.font&&b.setAttributeNS(null,"font-family",a.style.font);a.style.italic&&b.setAttributeNS(null,"font-style","italic");a.style.bold&&b.setAttributeNS(null,
"font-weight","bold");a.node=b;a.text=a.initialText;a.updateText=!0};j.Text.updateText=function(a){a.text!=""&&(a.node.firstChild?a.node.replaceChild(k.createTextNode(a.text),a.node.firstChild):a.node.appendChild(k.createTextNode(a.text)))};j.DisplayContainer=n(j.Display);j.DisplayContainer.rendererChild=function(a,b,c){var d;b.clipId?a.clipNode.hasOwnProperty(b.clipId)?d=a.clipNode[b.clipId]:(d=k.createElementNS("http://www.w3.org/2000/svg","g"),d.setAttributeNS(null,"clip-path","url(#"+b.clipId+
")"),d.setAttributeNS(null,"id","c_"+b.clipId),c?a.node.insertBefore(d,c.node):a.node.appendChild(d),a.clipNode[b.clipId]=d):d=a.node;b.isAppended===!1&&(c&&c.clipId===b.clipId?d.insertBefore(b.node,c.node):d.appendChild(b.node))};j.DisplayContainer.removeChild=function(a,b){b.node&&a.node.removeChild(b.node)};j.DisplayContainer.first=function(a){a.node=k.createElementNS("http://www.w3.org/2000/svg",a.clipDepth?"clipPath":"g");a.node.setAttributeNS(null,"id",a.id);a.name&&a.node.setAttributeNS(null,
"class",a.name);a.clipNode={}};j.Sprite=n(j.DisplayContainer);j.Stage=n(j.DisplayContainer);j.Stage.load=function(a){a.dom=k.createElementNS("http://www.w3.org/2000/svg","svg");a.defs=k.createElementNS("http://www.w3.org/2000/svg","defs");a.dom.appendChild(a.defs);var b=k.createElementNS("http://www.w3.org/2000/svg","rect");b.setAttributeNS(null,"x",0);b.setAttributeNS(null,"y",0);b.setAttributeNS(null,"width","100%");b.setAttributeNS(null,"height","100%");b.setAttributeNS(null,"fill",a.bgcolor);
a.dom.appendChild(b);a.isLoaded=!0};j.Stage.first=function(a){a.node=k.createElementNS("http://www.w3.org/2000/svg","g");a.node.setAttributeNS(null,"id",a.id);a.dom.appendChild(a.node);a.clipNode={}};j.Stage.updateSize=function(a){a.dom.setAttributeNS(null,"width",a.rect.width()/a.context.ratio);a.dom.setAttributeNS(null,"height",a.rect.height()/a.context.ratio);a.node.setAttributeNS(null,"transform","scale("+1/a.context.ratio+")")};q.svg=j;var u={left:0,center:1,right:2},v=/\(\#(.*)\)/,w=/[MLQZ]/,
x=/([0-9A-Fa-f]{6})/,y=/rgb\(([0-9,\.\-]*)\)/,h={displaySort:function(a,b){return a.depth-b.depth},Display:{load:function(a){a.isLoaded=!0},first:function(){},preRender:function(a){if(a.visible==="hidden")return!1;return!0},render:function(){},remove:function(){}}};h.Shape=n(h.Display);h.Shape.load=function(a,b){a.rect=new f.Rect(b.getAttribute("viewBox"));a.content=h.parseSvg(b,{});a.isLoaded=!0};h.Shape.render=function(a){var b=a.context.stage.ctx,c=a.transform.matrix!==null?!0:!1,d=a.transform.cxform!==
null?!0:!1,e=a.clipDepth>0?!0:!1;c&&b.addMatrix(a.transform.matrix);d&&b.addCxform(a.transform.cxform);h.renderShape(a.content,b,a.context,e);c&&b.removeMatrix();d&&b.removeCxform()};h.Bitmap=n(h.Display);h.Bitmap.load=function(a,b){a.url=a.context.baseurl+"/"+b.url;a.rect=new f.Rect([0,0,b.width,b.height]);var c=new Image;c.src=a.url;a.content=c;var d=function(){a.content.width>0||a.content.height>0?a.isLoaded=!0:setTimeout(d,0)};setTimeout(d,0)};h.Font=n(h.Display);h.Font.load=function(a,b){var c=
b.firstChild.getAttribute("font-family"),d=b.getAttribute("id"),e=k.getElementsByTagName("head"),f=k.createElement("style");f.innerHTML="@font-face{font-family:'"+c+"';src:url("+a.url+"#"+d+') format("svg");}';e.item(0).appendChild(f);a.isLoaded=!0};h.Text=n(h.Display);h.Text.first=function(a){var b={};a.style["word-wrap"]&&l.warn("word-wrap is no support on canvas");a.style.multiline&&l.warn("multiline is no support on canvas");a.style.border&&l.warn("border is not implement on canvas");a.style["left-mergin"]&&
l.warn("left-mergin is not implement on canvas");a.style["right-mergin"]&&l.warn("right-mergin is not implement on canvas");a.style.indent&&l.warn("indent is not implement on canvas");a.style.leading&&l.warn("leading is not implement on canvas");b.italic=a.style.italic?!0:!1;b.bold=a.style.bold?!0:!1;b.font=a.style.font?"'"+a.style.font+"'":!1;b.align=u[a.style.align?a.style.align:"left"];b.color=h.parseColor(a.style.color,a.style.opacity);b.size=a.style.size?a.style.size:!1;a.textStyle=b;a.text=
a.initialText};h.Text.updateText=function(){};h.Text.render=function(a){var b=a.context.stage.ctx,c=a.transform.matrix!==null?!0:!1,d=a.transform.cxform!==null?!0:!1;c&&b.addMatrix(a.transform.matrix);d&&b.addCxform(a.transform.cxform);b.renderEditText(a.text,a.rect,a.textStyle);c&&b.removeMatrix();d&&b.removeCxform()};h.DisplayContainer=n(h.Display);h.DisplayContainer.rendererChild=function(a,b){if(a.clipLayer.length>0)if(b.clipDepth>0)a.context.stage.ctx.save(b.clipId),a.isClip=!1;else if(b.clipId!=
null&&a.isClip!==!0)a.context.stage.ctx.clip(b.clipId),a.isClip=!0;else if(b.clipId!=null&&b.clipDepth==0&&a.isClip===!0)a.context.stage.ctx.restore(),a.isClip=!1};h.DisplayContainer.removeChild=function(){};h.Sprite=n(h.DisplayContainer);h.Sprite.preRender=function(a){if(a.visible==="hidden")return!1;a.transform.matrix!==null&&a.context.stage.ctx.addMatrix(a.transform.matrix);a.transform.cxform!==null&&a.context.stage.ctx.addCxform(a.transform.cxform);return!0};h.Sprite.render=function(a){a.transform.matrix!==
null&&a.context.stage.ctx.removeMatrix();a.transform.cxform!==null&&a.context.stage.ctx.removeCxform();a.isClip===!0&&a.context.stage.ctx.restore()};h.Stage=n(h.DisplayContainer);h.Stage.load=function(a){var b=k.createElement("div");b.setAttribute("style","background-color:"+a.bgcolor);a.dom=b};h.Stage.first=function(a){var b=k.createElement("canvas");b.id=a.id;b.width=a.rect.width()/a.context.ratio;b.height=a.rect.height()/a.context.ratio;a.dom.appendChild(b);a.isUpdateSize=!0;a.canvas=b;a.ctx=new m(b)};
h.Stage.preRender=function(a){if(a.isUpdateSize)a.canvas.width=a.rect.width()/a.context.ratio,a.canvas.height=a.rect.height()/a.context.ratio,a.isUpdateSize=!1;a.ctx.reset(a.context.ratio);return!0};h.Stage.updateSize=function(a){a.isUpdateSize=!0};h.parseSvg=function(a,b){switch(a.tagName){case "use":var c=a.getAttribute("xlink:href");return{type:4,use:c.replace("#",""),matrix:new f.Matrix(a.getAttribute("transform"))};case "path":var d={type:1,fill:!1,stroke:!1,data:[]};d.fill=h.parseColor(a.getAttribute("fill"),
a.getAttribute("fill-opacity"));if(typeof d.fill==="string"&&(c=v.exec(d.fill))!==null&&b.hasOwnProperty(c[1]))d.grad=b[c[1]];d.stroke=h.parseColor(a.getAttribute("stroke"),a.getAttribute("stroke-opacity"));if(d.stroke!==!1)d.strokeWidth=a.getAttribute("stroke-width");d.data=h.parsePathData(a.getAttribute("d"));return d;case "g":for(var e=[],d=a.childNodes.length,i=0,g,i=0;i<d;++i)g=h.parseSvg(a.childNodes[i],b),g!==!1&&e.push(g);return{type:3,item:e};case "linearGradient":case "radialGradient":for(var c=
a.getAttribute("id"),j=a.getAttribute("spreadMethod"),e=[],d=a.childNodes.length,i=0;i<d;++i)g=a.childNodes[i],e.push({color:g.getAttribute("stop-color"),offset:parseInt(g.getAttribute("offset"))/100});b[c]={sm:j,item:e};return!1;case "text":a.getAttribute("id");c=a.getAttribute("font-size");e=a.getAttribute("font-family");g=h.parseColor(a.getAttribute("fill"));for(var j=[],k,d=a.childNodes.length,i=0;i<d;++i)k=a.childNodes[i],j.push({x:k.getAttribute("x").split(" ")[0],y:k.getAttribute("y"),fontName:k.hasAttribute("font-family")?
k.getAttribute("font-family"):e,fontSize:k.hasAttribute("font-size")?k.getAttribute("font-size"):c,fill:k.hasAttribute("fill")?h.parseColor(k.getAttribute("fill")):g,text:k.textContent});return{type:2,texts:j};default:return l.warn("unknown type "+a.tagName,a),!1}};h.parsePathData=function(a){for(var b=[],a=a.split(" "),c,d;(c=a.shift())!==void 0;)switch(w.test(c)?d=c:a.unshift(c),d){case "M":case "L":b.push([d,Number(a.shift()),Number(a.shift())]);break;case "Q":b.push([d,Number(a.shift()),Number(a.shift()),
Number(a.shift()),Number(a.shift())]);break;case "Z":b.push([d])}return b};h.parseColor=function(a,b){var c=!1;if(a===void 0||a===null||a==="none")return!1;else if((c=x.exec(a))!==null)c=[parseInt("0x"+c[1].slice(0,2)),parseInt("0x"+c[1].slice(2,4)),parseInt("0x"+c[1].slice(4,6))];else if((c=y.exec(a))!==null)c=c[1].split(",").map(parseInt);else return a;b!==void 0&&b!==null&&b!==!1&&c.push((Number(b)*100+0.5|0)/100);return c};h.renderShape=function(a,b,c,d){switch(a.type){case 4:b.drawImage(c.dictionary[a.use].content,
a.matrix);break;case 1:var e=a.data.length,f;b.setup();for(var g=0;g<e;++g)c=a.data[g],f=c[0],b[f](c.slice(1));if(d)break;a.fill&&b.fill(a.fill);a.stroke&&b.stroke(a.stroke,a.strokeWidth);break;case 3:e=a.item.length;for(g=0;g<e;++g)h.renderShape(a.item[g],b,c,d);break;case 2:e=a.texts.length;b.setup();for(g=0;g<e;++g)b.renderStaticText(a.texts[g]);break;default:l.warn("unknown content type "+a)}};var m=function(a){this.canvas=a;this.ctx=a.getContext("2d");this.matrix=[];this.state=[];this._matrix=
null};m.prototype.reset=function(a){if(this.state.length>0)for(;this.state.length>0;)this.restore();this.ctx.clearRect(0,0,this.width,this.height);this.ctx.lineCap="round";this.ctx.lineJoin="round";this.width=this.canvas.width;this.height=this.canvas.height;this.scale=1/a;this.matrix=[new f.Matrix([this.scale,0,0,this.scale,0,0])];this.cxform=[]};m.prototype.addMatrix=function(a){this.matrix.push(a)};m.prototype.removeMatrix=function(){this.matrix.pop()};m.prototype.addCxform=function(a){this.cxform.push(a)};
m.prototype.removeCxform=function(){this.cxform.pop()};m.prototype.setup=function(){this._matrix=new f.Matrix;for(var a=this.matrix.length,b=0;b<a;++b)this._matrix=this._matrix.add(this.matrix[b]);this.ctx.beginPath()};m.prototype.transform=function(a,b){var c=this._matrix.transform(a,b);return{x:c.x+0.5|0,y:c.y+0.5|0}};m.prototype.colorTransform=function(a){var a=this._colorTransform(a),b,c,d,e=0;b=a.r+0.5|0;c=a.g+0.5|0;d=a.b+0.5|0;e=(a.a*100+0.5|0)/100;return e===1?"rgb("+b+","+c+","+d+")":"rgba("+
b+","+c+","+d+","+e+")"};m.prototype._colorTransform=function(a){var b={r:a[0],g:a[1],b:a[2],a:1};if(a.length>3)b.a=a[3];for(a=this.cxform.length;a>0;--a)b=this.cxform[a-1].transform(b.r,b.g,b.b,b.a);return b};m.prototype.M=function(a){a=this.transform(a[0],a[1]);this.ctx.moveTo(a.x,a.y)};m.prototype.L=function(a){a=this.transform(a[0],a[1]);this.ctx.lineTo(a.x,a.y)};m.prototype.Q=function(a){var b=this.transform(a[0],a[1]),a=this.transform(a[2],a[3]);this.ctx.quadraticCurveTo(b.x,b.y,a.x,a.y)};m.prototype.Z=
function(){this.ctx.closePath()};m.prototype.fill=function(a){var b="";typeof a==="string"?b=a:a.length>2&&(b=this.colorTransform(a));this.ctx.fillStyle=b;this.ctx.fill()};m.prototype.stroke=function(a,b){var c="";typeof a==="string"?c=a:a.length>2&&(c=this.colorTransform(a));this.ctx.lineWidth=b*this.scale;this.ctx.strokeStyle=c;this.ctx.stroke()};m.prototype.drawImage=function(a,b){this.addMatrix(b);this.setup();var c=this.transform(0,0),d=a.width*this._matrix.get_xscale(),e=a.height*this._matrix.get_yscale(),
f=this.ctx.globalAlpha,g=this._colorTransform([255,255,255,1]);if(g.a<1)this.ctx.globalAlpha=g.a;this.ctx.drawImage(a,c.x,c.y,d,e);this.removeMatrix();this.ctx.globalAlpha=f};m.prototype.renderStaticText=function(a){var b=this.transform(a.x,a.y),c=(a.fontSize*this.scale+0.5|0)+"px '"+a.fontName+"'";this.ctx.textAlign="left";this.ctx.fillStyle=this.colorTransform(a.fill);this.ctx.font=c;this.ctx.fillText(a.text,b.x,b.y)};m.prototype.renderEditText=function(a,b,c){var d,e=0,e={},f=[];switch(c.align){case 0:d=
b.xmin;break;case 1:d=b.width()/2+b.xmin;break;case 2:d=b.xmax}e=b.ymin+c.size;this.setup();e=this.transform(d,e);c.italic&&f.push("italic");c.bold&&f.push("italic");c.size&&f.push((c.size*this.scale+0.5|0)+"px");c.font&&f.push(c.font);this.ctx.textAlign=c.align;this.ctx.fillStyle=this.colorTransform(c.color);this.ctx.font=f.join(" ");this.ctx.fillText(a,e.x,e.y)};m.prototype.save=function(a){this.ctx.save();this.state.push(a)};m.prototype.clip=function(){this.ctx.clip()};m.prototype.restore=function(){this.state.pop();
this.ctx.restore()};h.Ctx=m;q.canvas=h})();
